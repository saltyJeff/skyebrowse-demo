angular.module("app",["app.core","app.page","app.users","app.video","app.profile","app.3dmodel","app.settings","app.contact","app.tutorial","md.data.table","ngStorage","firebase"]),angular.module("app.3dmodel",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),angular.module("app.contact",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),angular.module("app.core",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll"]),angular.module("app.layout",[]),angular.module("app.page",[]),angular.module("app.profile",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),angular.module("app.settings",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),angular.module("app.tutorial",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),angular.module("app.users",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),angular.module("app.video",["ngAnimate","ngAria","ngMessages","app.layout","app.i18n","oc.lazyLoad","ngMaterial","ui.router","duScroll","ngStorage","firebase"]),function(){angular.module("app.3dmodel").controller("view3dmodelCtrl",["$scope","$http","$sce","$mdDialog","$rootScope","$localStorage","$firebaseArray","$firebaseObject","$mdToast","$location","$filter",function(e,t,a,n,o,s,r,i,l,u,c){function d(){var t=e.toastPosition;t.bottom&&p.top&&(t.top=!1),t.top&&p.bottom&&(t.bottom=!1),t.right&&p.left&&(t.left=!1),t.left&&p.right&&(t.right=!1),p=angular.extend({},t)}0==s.skybrowselogin&&u.path("/page/signin"),e.curPage=0,e.pageSize=10,e.videosdisplay=[],e.videos=[],e.users=[],e.lieutenant=[],e.chief=[],e.demouser=[],e.officer=[],e.showloading=!1,o.currentuser&&(e.user=o.currentuser),o.$watch("currentuser",function(){e.user=o.currentuser}),!o.currentuser&&s.currentuser&&(o.currentuser=s.currentuser.role,e.user=o.currentuser),console.log(e.user);window.bucket;var p={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},p),e.getToastPosition=function(){return d(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")},e.openpotree=function(e){o.nowpotreelink=e.displaylink,console.log("nowpotreelink",o.nowpotreelink),u.path("/3dmodel/potreeview")};var g=i(firebase.database().ref("/settings/content"));g.$loaded().then(function(){e.toastdata=g,console.log("toastdata",e.toastdata)});var m={"Content-Type":"application/json"};o.currentuser.username,o.currentuser.auth_token;e.gotoaddvideo=function(){u.path("/video/addvideo")};var f={username:o.currentuser.username,manager_id:o.currentuser.id,auth_token:o.currentuser.auth_token};t.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",f,m).then(function(a){function n(){if(r<i){e.lieutenant[r].manager_id=o.currentuser.id,e.lieutenant[r].manager_username=o.currentuser.username;var a={username:e.lieutenant[r].username,manager_id:e.lieutenant[r].id,auth_token:e.lieutenant[r].auth_token};t.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",a,m).then(function(t){console.log("lieutenant res data",t.data.data);for(var o=t.data.data,s=0;s<o.length;s++)o[s].manager_id=a.manager_id,o[s].manager_username=a.username,e.officer.push(o[s]);r+=1,n()},function(e){console.log("lieutenant err",e),r+=1,n()})}}function n(){function a(){function n(){if(console.log("inside callmenow"),g<f){console.log("inside callmenow if");var a={"Content-Type":"application/json"},o={username:e.users[g].username,auth_token:e.users[g].auth_token};console.log("senddata",o),t.post("https://api.skyebrowse.com:3000/api/UserModels/fetchAllModels",o,a).then(function(t){console.log("get files",t);for(var a=t.data.data,o=0;o<a.length;o++)a[o].created_on=c("date")(a[o].created_on,"dd/MM/yyyy @ h:mma"),e.videos.push(a[o]);g+=1,n()},function(e){console.log("err file get",e),g+=1,n()})}else{for(var s=0;s<e.videos.length;s++)e.videosdisplay.push(e.videos[s]);console.log("videos display",e.videosdisplay)}}if(l<u){var s={username:e.lieutenant[l].username,manager_id:e.lieutenant[l].id,auth_token:e.lieutenant[l].auth_token};t.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",s,m).then(function(t){console.log("lieutenant res data",t.data.data);for(var n=t.data.data,o=0;o<n.length;o++)n[o].manager_id=s.manager_id,n[o].manager_username=s.username,e.officer.push(n[o]);l+=1,a()},function(e){console.log("lieutenant err",e),l+=1,a()})}else{for(var r=0;r<e.chief.length;r++)e.users.push(e.chief[r]);for(var i=0;i<e.lieutenant.length;i++)e.users.push(e.lieutenant[i]);for(var d=0;d<e.officer.length;d++)e.users.push(e.officer[d]);for(var p=0;p<e.demouser.length;p++)e.users.push(e.demouser[p]);e.users.push(o.currentuser),console.log("$scope.users",e.users);var g=0,f=e.users.length;n()}}if(r<i){e.chief[r].manager_id=o.currentuser.id,e.chief[r].manager_username=o.currentuser.username;var s={username:e.chief[r].username,manager_id:e.chief[r].id,auth_token:e.chief[r].auth_token};t.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",s,m).then(function(t){console.log("chief res data",t.data.data);for(var a=t.data.data,o=0;o<a.length;o++)a[o].manager_id=s.manager_id,a[o].manager_username=s.username,e.lieutenant.push(a[o]);r+=1,n()},function(e){console.log("chief err",e),r+=1,n()})}else{var l=0,u=e.lieutenant.length;a()}}if(console.log("managerdata",a.data.data),3==o.currentuser.access_level){e.users=a.data.data;for(var s=0;s<e.users.length;s++)e.users[s].manager_id=o.currentuser.id,e.users[s].manager_username=o.currentuser.username}else if(4==o.currentuser.access_level){e.lieutenant=a.data.data;var r=0,i=e.lieutenant.length;n();for(var l=0;l<e.lieutenant.length;l++)e.users.push(e.lieutenant[l]);for(var u=0;u<e.officer.length;u++)e.users.push(e.officer[u])}else if(5==o.currentuser.access_level){for(var d=a.data.data,p=0;p<d.length;p++)1==d[p].access_level?(d[p].manager_id=o.currentuser.id,d[p].manager_username=o.currentuser.username,e.demouser.push(d[p])):4==d[p].access_level&&e.chief.push(d[p]);var r=0,i=e.chief.length;n()}},function(e){console.log("managerdata err",e)}),e.numberOfPages=function(t){console.log(t,e.videosdisplay.length),e.pageSize=parseInt(t),e.pagenum=Math.ceil(e.videosdisplay.length/parseInt(t))}}]).filter("pagination",[function(){return function(e,t){return t=+t,e.slice(t)}}]).filter("trusted",[function(e){return function(t){return e.trustAsResourceUrl(t)}}])}(),function(){angular.module("app.contact").controller("contactCtrl",["$scope","$sce","$mdDialog","$rootScope","$localStorage","$firebaseArray","$firebaseObject","$mdToast","$location","$http",function(e,t,a,n,o,s,r,i,l,u){function c(){var t=e.toastPosition;t.bottom&&d.top&&(t.top=!1),t.top&&d.bottom&&(t.bottom=!1),t.right&&d.left&&(t.left=!1),t.left&&d.right&&(t.right=!1),d=angular.extend({},t)}0==o.skybrowselogin&&l.path("/page/signin"),e.contact={},e.showloading=!1;var d={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},d),e.getToastPosition=function(){return c(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var p=r(firebase.database().ref("/settings/content"));p.$loaded().then(function(){e.toastdata=p,console.log("toastdata",e.toastdata)}),e.save=function(t){e.showloading=!0;var a={name:t.name,mobile:t.mobile,email:t.email,subject:t.subject,description:t.description};u.post("https://send-mail-node-web.herokuapp.com/contactus/",a).then(function(t){e.showloading=!1,e.contact={},i.show(i.simple().content(e.toastdata.contactmailsenttoast).position(e.getToastPosition()).hideDelay(3e3))}).catch(function(t){console.log(t),e.showloading=!1,i.show(i.simple().content(e.toastdata.contactmailerrtoast).position(e.getToastPosition()).hideDelay(3e3))})}}]).directive("onlyDigits2",[function(){return{require:"ngModel",restrict:"A",link:function(e,t,a,n){n.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9, +, -]/g,"");return t!==e&&(n.$setViewValue(t),n.$render()),parseInt(t,10)}})}}}])}(),function(){angular.module("app.core").factory("appConfig",[function(){var e=[{name:"Fade up",class:"animate-fade-up"},{name:"Scale up",class:"ainmate-scale-up"},{name:"Slide in from right",class:"ainmate-slide-in-right"},{name:"Flip Y",class:"animate-flip-y"}],t={apiKey:"AIzaSyCL5Ew144JnXK8_jdcArOvG0zpZCi84LKk",authDomain:"webtoall-demo-project.firebaseapp.com",databaseURL:"https://webtoall-demo-project.firebaseio.com",projectId:"webtoall-demo-project",storageBucket:"webtoall-demo-project.appspot.com",messagingSenderId:"7846042188"};return firebase.initializeApp(t),{pageTransitionOpts:e,main:{brand:"Material",name:"Lisa",year:(new Date).getFullYear(),layout:"wide",menu:"vertical",isMenuCollapsed:!1,fixedHeader:!0,fixedSidebar:!0,pageTransition:e[0],skin:"12",link:"https://themeforest.net/item/material-design-admin-with-angularjs/13582227"},color:{primary:"#1BAACC",success:"#8BC34A",info:"#00BCD4",infoAlt:"#7E57C2",warning:"#FFCA28",danger:"#F44336",text:"#3D4051",gray:"#EDF0F1"}}}]).config(["$mdThemingProvider",function(e){var t=e.extendPalette("cyan",{contrastLightColors:"500 600 700 800 900",contrastStrongLightColors:"500 600 700 800 900"}),a=e.extendPalette("light-green",{contrastLightColors:"500 600 700 800 900",contrastStrongLightColors:"500 600 700 800 900"});e.definePalette("cyanAlt",t).definePalette("lightGreenAlt",a),e.theme("default").primaryPalette("teal",{default:"500"}).accentPalette("cyanAlt",{default:"500"}).warnPalette("red",{default:"500"}).backgroundPalette("grey")}])}(),function(){angular.module("app").controller("AppCtrl",["$scope","$rootScope","$state","$document","appConfig",function(e,t,a,n,o){e.pageTransitionOpts=o.pageTransitionOpts,e.main=o.main,e.color=o.color,e.$watch("main",function(a,n){"horizontal"===a.menu&&"vertical"===n.menu&&t.$broadcast("nav:reset"),!1===a.fixedHeader&&!0===a.fixedSidebar&&(!1===n.fixedHeader&&!1===n.fixedSidebar&&(e.main.fixedHeader=!0,e.main.fixedSidebar=!0),!0===n.fixedHeader&&!0===n.fixedSidebar&&(e.main.fixedHeader=!1,e.main.fixedSidebar=!1)),!0===a.fixedSidebar&&(e.main.fixedHeader=!0),!1===a.fixedHeader&&(e.main.fixedSidebar=!1)},!0),t.$on("$stateChangeSuccess",function(e,t,a){n.scrollTo(0,0)})}])}(),angular.module("app").config(["$ocLazyLoadProvider",function(e){e.config({debug:!1,events:!1,modules:[{name:"fontawesome",files:["node_modules/font-awesome/css/font-awesome.css"]},{name:"weather-icons",files:["node_modules/weather-icons/css/weather-icons.min.css"]},{name:"angular-material-data-table",files:["node_modules/angular-material-data-table/dist/md-data-table.min.js"]},{name:"angular-wizard",files:["node_modules/angular-wizard/dist/angular-wizard.min.js"]},{name:"email",files:["app/email/email.module.js","app/email/email.controller.js","app/email/email.service.js"],serie:!0},{name:"googlemap",files:["js!http://maps.google.com/maps/api/js","node_modules/ngmap/build/scripts/ng-map.min.js"]},{name:"fullcalendar",files:["node_modules/moment/min/moment.min.js","node_modules/fullcalendar/dist/fullcalendar.min.js","node_modules/angular-ui-calendar/src/calendar.js"],serie:!0}]})}]),angular.module("app").config(["$stateProvider","$urlRouterProvider","$ocLazyLoadProvider",function(e,t,a){var n;n=function(t){var a,n;return n="/"+t,a={url:n,templateUrl:"app/"+t+".html"},e.state(t,a),e},["page/forgot-password","page/signin","users/adduser","users/viewuser","video/addvideo","video/viewvideo","3dmodel/view3dmodel","3dmodel/potreeview","settings/settings","settings/emailsettings","app/page/update-password","contact/contactus","tutorial/viewtutorial"].forEach(function(e){return n(e)}),e.state("dashboard",{url:"/dashboard",templateUrl:"app/dashboard/dashboard.html"}).state("profile",{url:"/profile",templateUrl:"app/profile/profile.html"}).state("settings",{url:"/settings",templateUrl:"app/settings/settings.html"}).state("emailsettings",{url:"/emailsettings",templateUrl:"app/settings/emailsettings.html"}).state("adduser",{url:"/adduser",templateUrl:"app/users/adduser.html"}).state("viewuser",{url:"/viewuser",templateUrl:"app/users/viewuser.html"}).state("edituser",{url:"/edituser/:username",templateUrl:"app/users/edituser.html"}).state("update",{url:"/update/:username/:id",templateUrl:"app/page/update-password.html"}),t.when("/","/page/signin").otherwise("/page/signin")}]),function(){angular.module("app.i18n",["pascalprecht.translate"]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"assets/i18n/",suffix:".json"}),e.preferredLanguage("en"),e.useSanitizeValueStrategy(null)}]).controller("LangCtrl",["$scope","$translate",function(e,t){e.activeLang="english",e.setLang=function(a){switch(a){case"english":t.use("en");break;case"spanish":t.use("es");break;case"chinese":t.use("zh");break;case"japanese":t.use("ja")}return e.activeLang=a},e.langs=["english","spanish","chinese","japanese"]}])}(),function(){angular.module("app").controller("DashboardCtrl",["$scope","$sce","$filter","$mdDialog","$rootScope","$localStorage","$firebaseArray","$firebaseObject","$location","$http",function(e,t,a,n,o,s,r,i,l,u){function c(){var t=e.toastPosition;t.bottom&&d.top&&(t.top=!1),t.top&&d.bottom&&(t.bottom=!1),t.right&&d.left&&(t.left=!1),t.left&&d.right&&(t.right=!1),d=angular.extend({},t)}0==s.skybrowselogin&&l.path("/page/signin"),e.curPage=0,e.pageSize=10,e.videosdisplay=[],e.videos=[],e.users=[],e.lieutenant=[],e.chief=[],e.demouser=[],e.officer=[],e.showloading=!1,o.currentuser&&(e.user=o.currentuser),o.$watch("currentuser",function(){e.user=o.currentuser}),!o.currentuser&&s.currentuser&&(o.currentuser=s.currentuser.role,e.user=o.currentuser),console.log(e.user);var d={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},d),e.getToastPosition=function(){return c(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var p=i(firebase.database().ref("/settings/content"));p.$loaded().then(function(){e.toastdata=p});var g={"Content-Type":"application/json"};o.currentuser.username,o.currentuser.auth_token;e.gotoaddvideo=function(){l.path("/video/addvideo")};var m={username:o.currentuser.username,manager_id:o.currentuser.id,auth_token:o.currentuser.auth_token};u.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",m,g).then(function(t){function n(){if(r<i){e.lieutenant[r].manager_id=o.currentuser.id,e.lieutenant[r].manager_username=o.currentuser.username;var t={username:e.lieutenant[r].username,manager_id:e.lieutenant[r].id,auth_token:e.lieutenant[r].auth_token};u.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",t,g).then(function(a){console.log("lieutenant res data",a.data.data);for(var o=a.data.data,s=0;s<o.length;s++)o[s].manager_id=t.manager_id,o[s].manager_username=t.username,e.officer.push(o[s]);r+=1,n()},function(e){console.log("lieutenant err",e),r+=1,n()})}}function n(){function t(){if(c<d){var n={username:e.lieutenant[c].username,manager_id:e.lieutenant[c].id,auth_token:e.lieutenant[c].auth_token};u.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",n,g).then(function(a){console.log("lieutenant res data",a.data.data);for(var o=a.data.data,s=0;s<o.length;s++)o[s].manager_id=n.manager_id,o[s].manager_username=n.username,e.officer.push(o[s]);c+=1,t()},function(e){console.log("lieutenant err",e),c+=1,t()})}else{for(var s=0;s<e.chief.length;s++)e.users.push(e.chief[s]);for(var r=0;r<e.lieutenant.length;r++)e.users.push(e.lieutenant[r]);for(var i=0;i<e.officer.length;i++)e.users.push(e.officer[i]);for(var p=0;p<e.demouser.length;p++)e.users.push(e.demouser[p]);e.users.push(o.currentuser),console.log("$scope users",e.users);var m=0;!function(){var t=e.users.length;for(console.log("inside callmenow"),m;m<t;m++){console.log("inside callmenow for loop");var n={"Content-Type":"application/json"},s={username:e.users[m].username,auth_token:e.users[m].auth_token};u.post("https://api.skyebrowse.com:3000/api/UserModels/fetchAllModels",s,n).then(function(t){console.log("get files",t);for(var n=t.data.data.url,s=0;s<n.length;s++)n[s].created_on=a("date")(n[s].created_on,"MM/dd/yyyy  h:mma"),e.videos.push(n[s]),e.videosdisplay.push(n[s]);e.showloading=!1,e.videos.length&&(e.pagenum=Math.ceil(e.videos.length/e.pageSize)),e.openpotree=function(e){o.nowpotreelink=n,console.log("nowpotreelink",o.nowpotreelink),l.path("/3dmodel/potreeview")}},function(e){console.log("error getting files",e)})}}()}}if(r<i){e.chief[r].manager_id=o.currentuser.id,e.chief[r].manager_username=o.currentuser.username;var s={username:e.chief[r].username,manager_id:e.chief[r].id,auth_token:e.chief[r].auth_token};u.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",s,g).then(function(t){console.log("chief res data",t.data.data);for(var a=t.data.data,o=0;o<a.length;o++)a[o].manager_id=s.manager_id,a[o].manager_username=s.username,e.lieutenant.push(a[o]);r+=1,n()},function(e){console.log("chief err",e),r+=1,n()})}else{var c=0,d=e.lieutenant.length;t()}}if(console.log("managerdata",t.data.data),e.showloading=!0,3==o.currentuser.access_level){e.users=t.data.data;for(var s=0;s<e.users.length;s++)e.users[s].manager_id=o.currentuser.id,e.users[s].manager_username=o.currentuser.username}else if(4==o.currentuser.access_level){e.lieutenant=t.data.data;var r=0,i=e.lieutenant.length;n();for(var c=0;c<e.lieutenant.length;c++)e.users.push(e.lieutenant[c]);for(var d=0;d<e.officer.length;d++)e.users.push(e.officer[d])}else if(5==o.currentuser.access_level){for(var p=t.data.data,m=0;m<p.length;m++)1==p[m].access_level?(p[m].manager_id=o.currentuser.id,p[m].manager_username=o.currentuser.username,e.demouser.push(p[m])):4==p[m].access_level&&e.chief.push(p[m]);var r=0,i=e.chief.length;n()}},function(e){console.log("managerdata err",e)}),e.numberOfPages=function(t){console.log(t,e.videosdisplay.length),e.pageSize=parseInt(t),e.pagenum=Math.ceil(e.videosdisplay.length/parseInt(t))}}]).filter("trusted",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}])}(),function(){angular.module("app.layout").controller("CustomizerCtrl",["$scope",function(e){}]).controller("headerCtrl",["$scope","$firebaseArray","$firebaseObject","$localStorage","$rootScope",function(e,t,a,n,o){}]).controller("sidebarCtrl",["$scope","$firebaseArray","$firebaseObject","$localStorage","$rootScope",function(e,t,a,n,o){o.currentuser&&(e.user=o.currentuser),o.$watch("currentuser",function(){e.user=o.currentuser}),!o.currentuser&&n.currentuser&&(o.currentuser=n.currentuser,e.user=o.currentuser),console.log(e.user)}])}(),function(){angular.module("app.layout").directive("toggleQuickview",function(){return{restrict:"A",link:function(e,t,a){var n=$(t[0]),o=$("#app");n.on("click",function(e){if(t="quickview-open",a.target)var t=t+"-"+a.target;o.toggleClass(t),e.preventDefault()})}}}).directive("uiPreloader",["$rootScope",function(e){return{restrict:"A",template:'<span class="bar"></span>',link:function(e,t,a){t.addClass("preloaderbar hide"),e.$on("$stateChangeStart",function(e){t.removeClass("hide").addClass("active")}),e.$on("$stateChangeSuccess",function(e,a,n,o){e.targetScope.$watch("$viewContentLoaded",function(){t.addClass("hide").removeClass("active")})}),e.$on("preloader:active",function(e){t.removeClass("hide").addClass("active")}),e.$on("preloader:hide",function(e){t.addClass("hide").removeClass("active")})}}}])}(),function(){function e(){$("#loader-container").fadeOut("slow")}$(window).on("load",function(){setTimeout(e,1e3)})}(),function(){angular.module("app.layout").directive("toggleNavCollapsedMin",["$rootScope",function(e){return{restrict:"A",link:function(t,a,n){var o;o=$("#app"),a.on("click",function(t){return o.hasClass("nav-collapsed-min")?o.removeClass("nav-collapsed-min"):(o.addClass("nav-collapsed-min"),e.$broadcast("nav:reset")),t.preventDefault()})}}}]).directive("collapseNav",function(){return{restrict:"A",link:function(e,t,a){var n,o,s,r,i,l,u,c;l=$(window),(r=t.find("ul").parent("li")).append('<i class="material-icons icon-has-ul-h">keyboard_arrow_down</i>'),(n=r.children("a")).append('<i class="material-icons icon-has-ul">keyboard_arrow_down</i>'),o=t.children("li").not(r).children("a"),s=$("#app"),i=$("#nav-container"),n.on("click",function(e){var t;if(s.hasClass("nav-collapsed-min")||i.hasClass("nav-horizontal")&&l.width()>=768)return!1;t=$(this).parent("li"),r.not(t).removeClass("open").find("ul").slideUp(250),t.toggleClass("open").find("ul").stop().slideToggle(250),e.preventDefault()}),o.on("click",function(e){r.removeClass("open").find("ul").slideUp(250)}),e.$on("nav:reset",function(e){r.removeClass("open").find("ul").slideUp(250)}),u=l.width(),c=function(){var e;(e=l.width())<768&&s.removeClass("nav-collapsed-min"),u<768&&e>=768&&i.hasClass("nav-horizontal")&&r.removeClass("open").find("ul").slideUp(250),u=e},l.resize(function(){var e;clearTimeout(e),e=setTimeout(c,300)})}}}).directive("highlightActive",function(){return{restrict:"A",controller:["$scope","$element","$attrs","$location",function(e,t,a,n){var o,s,r;s=t.find("a"),r=function(){return n.path()},(o=function(e,t){return t="#!"+t,angular.forEach(e,function(e){var a,n,o;if(n=angular.element(e),a=n.parent("li"),o=n.attr("href"),a.hasClass("active")&&a.removeClass("active"),0===t.indexOf(o))return a.addClass("active")})})(s,n.path()),e.$watch(r,function(e,t){if(e!==t)return o(s,n.path())})}]}}).directive("toggleOffCanvas",function(){return{restrict:"A",link:function(e,t,a){t.on("click",function(){return $("#app").toggleClass("on-canvas")})}}})}(),function(){angular.module("app.page").controller("invoiceCtrl",["$scope","$window",function(e,t){var a,n,o;e.printInvoice=function(){a=document.getElementById("invoice").innerHTML,n=document.body.innerHTML,(o=window.open()).document.open(),o.document.write('<html><head><link rel="stylesheet" type="text/css" href="styles/main.css" /></head><body onload="window.print()">'+a+"</html>"),o.document.close()}}]).controller("authCtrl",["$scope","$window","$location","$state","$mdDialog","$firebaseObject","$firebaseArray","$localStorage","$rootScope","$http",function(e,t,a,n,o,s,r,i,l,u){e.inputType="password",e.hideshow=!0,e.hideShowPassword=function(){e.hideshow=!e.hideshow,"password"==e.inputType?e.inputType="text":e.inputType="password"},e.user={},i.currentuser=void 0,i.skybrowselogin=!1,l.currentuser=null;var c,d=s(firebase.database().ref("/settings/content"));d.$loaded().then(function(){e.toastdata=d,console.log("toastdata",e.toastdata)}),e.login=function(t){var n={"Content-Type":"application/json"};t.username&&t.password?u.post("https://api.skyebrowse.com:3000/api/Consumer/signin",t,n).then(function(t){console.log("res",t),1==t.data.success?(i.skybrowselogin=!0,c=!0,i.currentuser=t.data.data,l.currentuser=t.data.data,console.log("login",l.currentuser),a.path("/dashboard")):(o.show(o.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Alert").content(e.toastdata.loginerrortoast).ariaLabel("Alert").ok("OK")),e.user={})},function(e){o.show(o.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Alert").content("Can't  able to reach server. Try again later.").ariaLabel("Alert").ok("OK"))}):o.show(o.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Alert").content(e.toastdata.usernamepasswordreqtoast).ariaLabel("Alert").ok("OK"))}}]).controller("updateCtrl",["$scope","$window","$location","$state","$mdDialog","$firebaseObject","$firebaseArray","$localStorage","$rootScope","$stateParams",function(e,t,a,n,o,s,r,i,l,u){console.log(u.id,u.username),e.user={};var c=s(firebase.database().ref("/users/"+u.id));c.$loaded().then(function(){0==c.isauth?e.display=!0:e.display=!1}),e.inputType="password",e.hideshow=!0,e.hideShowPassword=function(){e.hideshow=!e.hideshow,"password"==e.inputType?e.inputType="text":e.inputType="password"},e.inputType1="password",e.hideshow1=!0,e.hideShowPassword1=function(){e.hideshow1=!e.hideshow1,"password"==e.inputType1?e.inputType1="text":e.inputType1="password"},e.changepassword=function(t){if(t.password&&t.confirmpassword)if(t.password==t.confirmpassword){var n=firebase.database().ref("/users/"+u.id);n.child("password").set(t.password),n.child("isauth").set(!0),a.path("/page/signin")}else o.show(o.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Alert").content(e.toastdata.passworderrortoast).ariaLabel("Alert").ok("OK"));else o.show(o.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Alert").content(e.toastdata.passwordreqtoast).ariaLabel("Alert").ok("OK"))}}]).directive("ngEnter",[function(){return function(e,t,a){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(a.ngEnter)}),t.preventDefault())})}}])}(),function(){angular.module("app.page").directive("customPage",function(){return{restrict:"A",controller:["$scope","$element","$location",function(e,t,a){var n,o;o=function(){return a.path()},(n=function(e){console.log("path",e);var a=e.split("/");console.log("data",a[1]);var n,o;switch("update"==a[1]&&(n=a[2],o=a[3]),t.removeClass("on-canvas"),t.removeClass("body-wide body-err body-lock body-auth"),e){case"/404":case"/page/404":case"/page/500":return t.addClass("body-wide body-err");case"/page/signin":case"/page/signup":case"/page/forgot-password":case"/update/"+n+"/"+o:return t.addClass("body-wide body-auth");case"/page/lock-screen":return t.addClass("body-wide body-lock")}})(a.path()),e.$watch(o,function(e,t){if(e!==t)return n(a.path())})}]}})}(),function(){angular.module("app.profile").controller("profileCtrl",["$scope","$stateParams","$firebaseArray","$firebaseObject","$localStorage","$mdToast","$rootScope","$location",function(e,t,a,n,o,s,r,i){function l(){var t=e.toastPosition;t.bottom&&c.top&&(t.top=!1),t.top&&c.bottom&&(t.bottom=!1),t.right&&c.left&&(t.left=!1),t.left&&c.right&&(t.right=!1),c=angular.extend({},t)}function u(t){return new Promise(function(a,n){if(console.log("$scope.user.image",e.user.image),console.log("$localStorage.userimage1",o.userimage1),void 0!==e.user.image)void 0!==e.user.image.url&&(console.log("inside if"),(s=firebase.storage().refFromURL(e.user.image.url)).delete().then(function(){console.log("successfully deleted"),e.user.image={};var a=firebase.storage().ref("users/"+t.name).put(t);a.on("state_changed",function(e){},function(e){},function(){var n=a.snapshot.downloadURL,s={name:t.name,url:n};console.log(s),e.showdiv=!1,o.userimage1=s,e.$apply(function(){e.image1=o.userimage1})})}).catch(function(e){console.log("error",e)}));else if(0!==Object.keys(o.userimage1).length){console.log("inside else if"),console.log("$localStorage.userimage1.url",o.userimage1.url);var s=firebase.storage().refFromURL(o.userimage1.url);s.delete().then(function(){console.log("successfully deleted"),o.userimage1={},e.image1={};var a=firebase.storage().ref("users/"+t.name).put(t);a.on("state_changed",function(e){},function(e){},function(){var n=a.snapshot.downloadURL,s={name:t.name,url:n};console.log(s),e.showdiv=!1,o.userimage1=s,e.$apply(function(){e.image1=o.userimage1})})}).catch(function(e){console.log("error",e)})}else{console.log("inside else");var r=firebase.storage().ref("users/"+t.name).put(t);r.on("state_changed",function(e){},function(e){},function(){var a=r.snapshot.downloadURL,n={name:t.name,url:a};console.log(n),e.showdiv=!1,o.userimage1=n,e.$apply(function(){e.image1=o.userimage1})})}})}0==o.skybrowselogin&&i.path("/page/signin"),o.userimage1={},e.user={},e.image1={},e.showdiv=!1,e.inputType="password",e.hideshow=!0,e.hideShowPassword=function(){e.hideshow=!e.hideshow,"password"==e.inputType?e.inputType="text":e.inputType="password"};var c={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},c),e.getToastPosition=function(){return l(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")},e.roles=[{text:"Police Chief",value:"Police Chief"},{text:"Police Department",value:"Police Department"},{text:"User",value:"User"}];var d=a(firebase.database().ref("/users"));d.$loaded().then(function(){e.users=d;for(var t=0;t<e.users.length;t++)e.users[t].username==o.currentuser.username&&(e.user=e.users[t])});var p=n(firebase.database().ref("/settings/content"));p.$loaded().then(function(){e.toastdata=p,console.log("toastdata",e.toastdata)});var g=-1;e.imgFile=function(t){var a=t.target.files[0];console.log("inside imgFile"),g=parseInt(g)+1,console.log("call",g),console.log(" profile imageFile",a),"image/png"==a.type||"image/jpg"==a.type||"image/jpeg"==a.type?(console.log("if"),u(a),e.$apply(function(){void 0!=a&&(e.showdiv=!0)})):0==parseInt(g%2)&&(console.log("else"),s.show(s.simple().content(e.toastdata.imgvalidatetoast).position(e.getToastPosition()).hideDelay(3e3)),a=null)},e.updateprofile=function(t){var a=firebase.database().ref("/users/"+e.user.$id);a.child("name").set(t.name),a.child("mobile").set(t.mobile),a.child("role").set(t.role),a.child("username").set(t.username),a.child("password").set(t.password),a.child("gender").set(t.gender),t.email&&a.child("email").set(t.email),0!==Object.keys(o.userimage1).length&&(a.child("image").set(o.userimage1),r.image=o.userimage1.url),s.show(s.simple().content(e.toastdata.profileupdatetoast).position(e.getToastPosition()).hideDelay(3e3)),o.userimage1={},e.image1={},i.path("/dashboard")}}]).directive("customOnChange",[function(){return{restrict:"A",link:function(e,t,a){console.log("inside directive");var n=e.$eval(a.customOnChange);t.on("change",n),t.on("$destroy",function(){t.off()})}}}]).directive("onlyDigits1",[function(){return{require:"ngModel",restrict:"A",link:function(e,t,a,n){n.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9, +]/g,"");return t!==e&&(n.$setViewValue(t),n.$render()),parseInt(t,10)}})}}}])}(),function(){angular.module("app.settings").controller("settingsCtrl",["$scope","$stateParams","$firebaseArray","$firebaseObject","$localStorage","$mdToast","$rootScope","$location","$mdDialog",function(e,t,a,n,o,s,r,i,l){function u(){var t=e.toastPosition;t.bottom&&c.top&&(t.top=!1),t.top&&c.bottom&&(t.bottom=!1),t.right&&c.left&&(t.left=!1),t.left&&c.right&&(t.right=!1),c=angular.extend({},t)}0!=o.skybrowselogin&&"Admin"==o.currentuser.role||i.path("/page/signin"),e.curPage=0,e.pageSize=5,e.stateName="",e.states=[];var c={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},c),e.getToastPosition=function(){return u(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var d=n(firebase.database().ref("/settings/content"));d.$loaded().then(function(){e.toastdata=d,console.log("toastdata",e.toastdata)});var p=n(firebase.database().ref("/emailsettings"));p.$loaded().then(function(){e.mail=p,console.log("maildata",e.mail)});var g=firebase.database().ref("/settings/states"),m=a(g);m.$loaded().then(function(){e.states=m;for(var t=0;t<e.states.length;t++)e.states[t].id=parseInt(t)+1,e.states[t].viewedit=!1;console.log("states",e.states),e.states.length&&(e.pagenum=Math.ceil(e.states.length/e.pageSize),console.log("pagenum",e.pagenum))}),e.numberOfPages=function(t){e.pageSize=parseInt(t),e.pagenum=Math.ceil(e.states.length/parseInt(t))},e.inputType="password",e.hideshow=!0,e.hideShowPassword=function(){e.hideshow=!e.hideshow,"password"==e.inputType?e.inputType="text":e.inputType="password"},e.editstate=function(t){e.nowstate={},e.nowstate=t,e.nowstate.viewedit=!0,console.log("nowstate",e.nowstate)},e.savestate=function(t){console.log("state data",t),firebase.database().ref("/settings/states").push({statename:t}),e.stateName="",s.show(s.simple().content(e.toastdata.addstatetoast).position(e.getToastPosition()).hideDelay(3e3));var n=firebase.database().ref("/settings/states"),o=a(n);o.$loaded().then(function(){e.states=o;for(var t=0;t<e.states.length;t++)e.states[t].id=parseInt(t)+1,e.states[t].viewedit=!1;console.log("states",e.states),e.states.length&&(e.pagenum=Math.ceil(e.states.length/e.pageSize),console.log("pagenum",e.pagenum))})},e.delete=function(t){var n=l.confirm().title("Confirmation").content(e.toastdata.deletestateconfirmtext).ok("Yes").cancel("No");l.show(n).then(function(){firebase.database().ref("/settings/states/"+t.$id).set({});var n=firebase.database().ref("/settings/states"),o=a(n);o.$loaded().then(function(){e.states=o;for(var t=0;t<e.states.length;t++)e.states[t].id=parseInt(t)+1,e.states[t].viewedit=!1;console.log("states",e.states),e.states.length&&(e.pagenum=Math.ceil(e.states.length/e.pageSize),console.log("pagenum",e.pagenum)),l.hide(),s.show(s.simple().content(e.toastdata.deletestatetoast).position(e.getToastPosition()).hideDelay(3e3))})},function(){})},e.updatesettings=function(t){console.log("update data",t),console.log("imgvalidatetoast data",t.imgvalidatetoast);var a=firebase.database().ref("/settings/content");a.child("addusertoast").set(t.addusertoast),a.child("updateusertoast").set(t.updateusertoast),a.child("deleteusertoast").set(t.deleteusertoast),a.child("deleteuserconfirmtext").set(t.deleteuserconfirmtext),a.child("addvideotoast").set(t.addvideotoast),a.child("deletevideotoast").set(t.deletevideotoast),a.child("deletevideoconfirmtext").set(t.deletevideoconfirmtext),a.child("profileupdatetoast").set(t.profileupdatetoast),a.child("settingsupdatetoast").set(t.settingsupdatetoast),a.child("addstatetoast").set(t.addstatetoast),a.child("updatestatetoast").set(t.updatestatetoast),a.child("deletestatetoast").set(t.deletestatetoast),a.child("deletestateconfirmtext").set(t.deletestateconfirmtext),a.child("imgvalidatetoast").set(t.imgvalidatetoast),a.child("usernamevalidatetoast").set(t.usernamevalidatetoast),a.child("emailvalidatetoast").set(t.emailvalidatetoast),a.child("mailsenttoast").set(t.mailsenttoast),a.child("mailresenttoast").set(t.mailresenttoast),a.child("uploadvideotoast").set(t.uploadvideotoast),a.child("videofilevalidatetoast").set(t.videofilevalidatetoast),a.child("videofilesizetoast").set(t.videofilesizetoast),a.child("loginerrortoast").set(t.loginerrortoast),a.child("usernamepasswordreqtoast").set(t.usernamepasswordreqtoast),a.child("passworderrortoast").set(t.passworderrortoast),a.child("passwordreqtoast").set(t.passwordreqtoast),a.child("contactmailsenttoast").set(t.contactmailsenttoast),a.child("contactmailerrtoast").set(t.contactmailerrtoast),s.show(s.simple().content(e.toastdata.settingsupdatetoast).position(e.getToastPosition()).hideDelay(3e3))},e.showdetail=function(t,a){console.log("data",a),l.show({controller:["$scope","$mdDialog","nowstate",function(e,t,a){e.nowstate=a,e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(e){t.hide(e)}}],templateUrl:"dialog2.tmpl.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:e.customFullscreen,scope:e,preserveScope:!0,locals:{nowstate:a}}).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."})},e.updatestate=function(t){console.log("data",t),firebase.database().ref("/settings/states/"+t.$id).child("statename").set(t.statename),s.show(s.simple().content(e.toastdata.updatestatetoast).position(e.getToastPosition()).hideDelay(3e3));var n=firebase.database().ref("/settings/states"),o=a(n);o.$loaded().then(function(){e.states=o;for(var t=0;t<e.states.length;t++)e.states[t].id=parseInt(t)+1,e.states[t].viewedit=!1;console.log("states",e.states),e.states.length&&(e.pagenum=Math.ceil(e.states.length/e.pageSize),console.log("pagenum",e.pagenum))})},e.updateemailsettings=function(t){var a=firebase.database().ref("/emailsettings");a.child("username").set(t.username),a.child("email").set(t.email),a.child("password").set(t.password),s.show(s.simple().content(e.toastdata.settingsupdatetoast).position(e.getToastPosition()).hideDelay(3e3)),i.path("/dashboard")}}])}(),function(){angular.module("app.tutorial").controller("viewtutorialCtrl",["$scope","$sce","$mdDialog","$rootScope","$localStorage","$firebaseArray","$firebaseObject","$location",function(e,t,a,n,o,s,r,i){console.log("inside viewtutorialCtrl"),0==o.skybrowselogin&&i.path("/page/signin")}]).filter("trusted1",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}])}(),function(){angular.module("app.users").controller("adduserCtrl",["$scope","$firebaseArray","$firebaseObject","$localStorage","$location","$mdToast","$http","$rootScope",function(e,t,a,n,o,s,r,i){function l(){var t=e.toastPosition;t.bottom&&u.top&&(t.top=!1),t.top&&u.bottom&&(t.bottom=!1),t.right&&u.left&&(t.left=!1),t.left&&u.right&&(t.right=!1),u=angular.extend({},t)}console.log("inside adduser"),0==n.skybrowselogin&&o.path("/page/signin"),e.chief=[],e.lieutenant=[],5==i.currentuser.access_level&&(e.admin=[],e.admin.push(i.currentuser)),e.managers=[],e.inputType="password",e.hideshow=!0,e.hideShowPassword=function(){e.hideshow=!e.hideshow,"password"==e.inputType?e.inputType="text":e.inputType="password"},e.showloading=!1,e.user={},e.showdiv=!1;var u={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},u),e.getToastPosition=function(){return l(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var c=a(firebase.database().ref("/settings/content"));c.$loaded().then(function(){e.toastdata=c,console.log("toastdata",e.toastdata)});var d={"Content-Type":"application/json"},p={username:i.currentuser.username,manager_id:i.currentuser.id,auth_token:i.currentuser.auth_token};r.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",p,d).then(function(t){function a(){if(s<l){var t={username:e.chief[s].username,manager_id:e.chief[s].id,auth_token:e.chief[s].auth_token};r.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",t,d).then(function(t){console.log("lieutenant res data",t.data.data);for(var n=t.data.data,o=0;o<n.length;o++)3==n[o].access_level&&e.lieutenant.push(n[o]);s+=1,a()},function(e){console.log("lieutenant err",e),s+=1,a()})}}if(console.log("managerdata",t.data.data),5==i.currentuser.access_level){for(var n=t.data.data,o=0;o<n.length;o++)4==n[o].access_level&&e.chief.push(n[o]);var s=0,l=e.chief.length;a()}else 4==i.currentuser.access_level?(e.chief.push(i.currentuser),e.lieutenant=t.data.data):e.lieutenant.push(i.currentuser)},function(e){console.log("managerdata err",e)});var g={username:i.currentuser.username,auth_token:i.currentuser.auth_token};r.post("https://api.skyebrowse.com:3000/api/Authorization/getAllAuthLevels",g,d).then(function(t){console.log(t.data.data);var a=t.data.data;if(e.roles=[],5==i.currentuser.access_level)for(n=0;n<a.length;n++)5!=a[n].id&&e.roles.push(a[n]);else if(4==i.currentuser.access_level)for(n=0;n<a.length;n++)5!=a[n].id&&4!=a[n].id&&1!=a[n].id&&e.roles.push(a[n]);else if(3==i.currentuser.access_level)for(var n=0;n<a.length;n++)5!=a[n].id&&4!=a[n].id&&3!=a[n].id&&1!=a[n].id&&e.roles.push(a[n])},function(e){console.log("err get auth level",e)}),e.getmanagers=function(t){if(e.managers=[],console.log("data",t),4==t||1==t)for(console.log("$scope.admin",e.admin),a=0;a<e.admin.length;a++)e.managers.push(e.admin[a]);else if(3==t){for(console.log("$scope.chief",e.chief),a=0;a<e.chief.length;a++)console.log("inside for"),e.managers.push(e.chief[a]);console.log("$scope.managers",e.managers)}else if(2==t){console.log("$scope.lieutenant",e.lieutenant);for(var a=0;a<e.lieutenant.length;a++)e.managers.push(e.lieutenant[a])}},e.adduser=function(t){t.access_level=t.role,e.showloading=!0;var a={"Content-Type":"application/json"};console.log("adduser",t),r.post("https://api.skyebrowse.com:3000/api/Consumer/newConsumer",t,a).then(function(t){console.log("add user",t),1==t.data.success?(e.showloading=!1,s.show(s.simple().content(e.toastdata.addusertoast).position(e.getToastPosition()).hideDelay(3e3)),e.user={},o.path("/viewuser")):(e.showloading=!1,s.show(s.simple().content(t.data.msg).position(e.getToastPosition()).hideDelay(3e3)))},function(t){console.log("err add user",t),e.showloading=!1,s.show(s.simple().content(t.data.msg).position(e.getToastPosition()).hideDelay(3e3))})}}]).controller("viewuserCtrl",["$scope","$firebaseArray","$firebaseObject","$localStorage","$mdDialog","$mdToast","$http","$location","$rootScope",function(e,t,a,n,o,s,r,i,l){function u(){var t=e.toastPosition;t.bottom&&c.top&&(t.top=!1),t.top&&c.bottom&&(t.bottom=!1),t.right&&c.left&&(t.left=!1),t.left&&c.right&&(t.right=!1),c=angular.extend({},t)}0==n.skybrowselogin&&i.path("/page/signin"),e.curPage=0,e.pageSize=10,e.users=[],e.lieutenant=[],e.chief=[],e.demouser=[],e.officer=[],e.showloading=!1;var c={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},c),e.getToastPosition=function(){return u(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var d=a(firebase.database().ref("/settings/content"));d.$loaded().then(function(){e.toastdata=d,console.log("toastdata",e.toastdata)});var p={"Content-Type":"application/json"},g={username:l.currentuser.username,manager_id:l.currentuser.id,auth_token:l.currentuser.auth_token};r.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",g,p).then(function(t){function a(){if(o<s){e.lieutenant[o].manager_id=l.currentuser.id,e.lieutenant[o].manager_username=l.currentuser.username;var t={username:e.lieutenant[o].username,manager_id:e.lieutenant[o].id,auth_token:e.lieutenant[o].auth_token};r.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",t,p).then(function(n){console.log("lieutenant res data",n.data.data);for(var s=n.data.data,r=0;r<s.length;r++)s[r].manager_id=t.manager_id,s[r].manager_username=t.username,e.officer.push(s[r]);o+=1,a()},function(e){console.log("lieutenant err",e),o+=1,a()})}}if(console.log("managerdata",t.data.data),e.showloading=!0,3==l.currentuser.access_level){e.users=t.data.data;for(var n=0;n<e.users.length;n++)e.users[n].manager_id=l.currentuser.id,e.users[n].manager_username=l.currentuser.username;e.showloading=!1}else if(4==l.currentuser.access_level){e.lieutenant=t.data.data;var o=0,s=e.lieutenant.length;a();for(var i=0;i<e.lieutenant.length;i++)e.users.push(e.lieutenant[i]);for(var u=0;u<e.officer.length;u++)e.users.push(e.officer[u]);e.showloading=!1}else if(5==l.currentuser.access_level){console.log("inside five");for(var c=t.data.data,d=0;d<c.length;d++)1==c[d].access_level?(c[d].manager_id=l.currentuser.id,c[d].manager_username=l.currentuser.username,e.demouser.push(c[d])):4==c[d].access_level&&e.chief.push(c[d]),d==parseInt(c.length-1)&&function(){function t(){function o(){if(i<u){var t={username:e.lieutenant[i].username,manager_id:e.lieutenant[i].id,auth_token:e.lieutenant[i].auth_token};r.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",t,p).then(function(a){console.log("lieutenant res data",a.data.data);for(var n=a.data.data,s=0;s<n.length;s++)n[s].manager_id=t.manager_id,n[s].manager_username=t.username,e.officer.push(n[s]);i+=1,o()},function(e){console.log("lieutenant err",e),i+=1,o()})}else{for(var a=0;a<e.chief.length;a++)e.users.push(e.chief[a]);for(var n=0;n<e.lieutenant.length;n++)e.users.push(e.lieutenant[n]);for(var s=0;s<e.officer.length;s++)e.users.push(e.officer[s]);for(var l=0;l<e.demouser.length;l++)e.users.push(e.demouser[l]);console.log("$scope.users",e.users),e.users.length&&(e.pagenum=Math.ceil(e.users.length/e.pageSize)),e.showloading=!1}}if(a<n){e.chief[a].manager_id=l.currentuser.id,e.chief[a].manager_username=l.currentuser.username;var s={username:e.chief[a].username,manager_id:e.chief[a].id,auth_token:e.chief[a].auth_token};r.post("https://api.skyebrowse.com:3000/api/Consumer/getEmployees",s,p).then(function(n){console.log("chief res data",n.data.data);for(var o=n.data.data,r=0;r<o.length;r++)o[r].manager_id=s.manager_id,o[r].manager_username=s.username,e.lieutenant.push(o[r]);a+=1,t()},function(e){console.log("chief err",e),a+=1,t()})}else{var i=0,u=e.lieutenant.length;o()}}console.log("$scope.chief.length",e.chief.length);var a=0,n=e.chief.length;t()}()}},function(e){console.log("managerdata err",e)}),e.numberOfPages=function(t){e.pageSize=parseInt(t),e.pagenum=Math.ceil(e.users.length/parseInt(t))}}]).controller("edituserCtrl",["$scope","$stateParams","$firebaseArray","$firebaseObject","$localStorage","$location","$mdToast","$http",function(e,t,a,n,o,s,r,i){function l(){var t=e.toastPosition;t.bottom&&u.top&&(t.top=!1),t.top&&u.bottom&&(t.bottom=!1),t.right&&u.left&&(t.left=!1),t.left&&u.right&&(t.right=!1),u=angular.extend({},t)}0==o.skybrowselogin&&s.path("/page/signin"),e.user={},e.showdiv=!1,e.showloading=!1,e.inputType="password",e.hideshow=!0,e.hideShowPassword=function(){e.hideshow=!e.hideshow,"password"==e.inputType?e.inputType="text":e.inputType="password"};var u={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},u),e.getToastPosition=function(){return l(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var c={"Content-Type":"application/json"},d={username:$rootScope.currentuser.username,auth_token:$rootScope.currentuser.auth_token};i.post("https://api.skyebrowse.com:3000/api/Authorization/getAllAuthLevels",d,c).then(function(t){console.log(t.data.data);var a=t.data.data;if(e.roles=[],5==$rootScope.currentuser.access_level)for(n=0;n<a.length;n++)5!=a[n].id&&e.roles.push(a[n]);else if(4==$rootScope.currentuser.access_level)for(n=0;n<a.length;n++)5!=a[n].id&&4!=a[n].id&&1!=a[n].id&&e.roles.push(a[n]);else if(3==$rootScope.currentuser.access_level)for(var n=0;n<a.length;n++)5!=a[n].id&&4!=a[n].id&&3!=a[n].id&&1!=a[n].id&&e.roles.push(a[n])},function(e){console.log("err get auth level",e)});var p=n(firebase.database().ref("/settings/content"));p.$loaded().then(function(){e.toastdata=p,console.log("toastdata",e.toastdata)});var g=a(firebase.database().ref("/users"));g.$loaded().then(function(){e.users=g;for(var a=0;a<e.users.length;a++)e.users[a].username==t.username&&(e.user=e.users[a],o.editid=e.users[a].$id)});var m=n(firebase.database().ref("/users/"+o.editid));m.$loaded().then(function(){o.nowedituser=m}),e.edituser=function(t){if(e.showloading=!0,console.log(t.role,o.nowedituser.role),o.nowedituser.role==t.role)(a=firebase.database().ref("/users/"+e.user.$id)).child("name").set(t.name),a.child("mobile").set(t.mobile),a.child("role").set(t.role),a.child("username").set(t.username),a.child("gender").set(t.gender),t.email&&a.child("email").set(t.email),0!==Object.keys(o.userimage1).length&&a.child("image").set(o.userimage1),r.show(r.simple().content(e.toastdata.updateusertoast).position(e.getToastPosition()).hideDelay(3e3)),o.userimage1={},e.image1={},e.showloading=!1,s.path("/viewuser");else{var a=firebase.database().ref("/users/"+e.user.$id);a.child("name").set(t.name),a.child("mobile").set(t.mobile),a.child("role").set(t.role),a.child("username").set(t.username),a.child("gender").set(t.gender),t.email&&a.child("email").set(t.email),0!==Object.keys(o.userimage1).length&&a.child("image").set(o.userimage1);var n={username:t.username,role:t.role,email:t.email,subject:"Updation in your Role"};i.post("https://send-mail-node-web.herokuapp.com/sendRoleUpdate/",n).then(function(a){console.log(a),firebase.database().ref("/users/"+t.$id).child("updation").set(!1),r.show(r.simple().content(e.toastdata.updateusertoast).position(e.getToastPosition()).hideDelay(3e3)),e.showloading=!1,o.userimage1={},e.image1={},s.path("/viewuser")}).catch(function(a){console.log(a),firebase.database().ref("/users/"+t.$id).child("updation").set(!0),r.show(r.simple().content(e.toastdata.mailresenttoast).position(e.getToastPosition()).hideDelay(3e3)),e.showloading=!1,o.userimage1={},e.image1={},s.path("/viewuser")})}}}]).directive("customOnChange",[function(){return{restrict:"A",link:function(e,t,a){var n=e.$eval(a.customOnChange);t.on("change",n),t.on("$destroy",function(){t.off()})}}}]).directive("onlyDigits",[function(){return{require:"ngModel",restrict:"A",link:function(e,t,a,n){n.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9, +, -]/g,"");return t!==e&&(n.$setViewValue(t),n.$render()),parseInt(t,10)}})}}}]).filter("pagination",[function(){return function(e,t){return t=+t,e.slice(t)}}])}(),function(){angular.module("app.video").controller("viewvideoCtrl",["$scope","$http","$sce","$mdDialog","$rootScope","$localStorage","$mdToast","$filter","$location","$firebaseArray","$firebaseObject",function(e,t,a,n,o,s,r,i,l,u,c){function d(){var t=e.toastPosition;t.bottom&&g.top&&(t.top=!1),t.top&&g.bottom&&(t.bottom=!1),t.right&&g.left&&(t.left=!1),t.left&&g.right&&(t.right=!1),g=angular.extend({},t)}function p(a,n,s){console.log("inside callme",n,a,o.currentuser);var i={"Content-Type":"application/json"},u={file_name:n,access_level:o.currentuser.access_level,username:o.currentuser.username,s3location:s,file_type:"video/mp4",auth_token:o.currentuser.auth_token};t.post("https://api.skyebrowse.com:3000/api/UserModels/updateFileUploadStatus",u,i).then(function(t){console.log("update status",t),e.showloading=!1,o.filename=null,e.video={},l.path("/3dmodel/view3dmodel"),r.show(r.simple().content(e.toastdata.addvideotoast).position(e.getToastPosition()).hideDelay(4e3))},function(t){console.log("update status err",t),e.showloading=!1,o.filename=null,r.show(r.simple().content(t.data.error.message).position(e.getToastPosition()).hideDelay(4e3))})}0==s.skybrowselogin&&l.path("/page/signin"),e.curPage=0,e.pageSize=10,e.showloading=!1,e.video={},o.filename="",e.maxDate=new Date,console.log("$scope.maxDate",e.maxDate),o.currentuser&&(e.user=o.currentuser),o.$watch("currentuser",function(){e.user=o.currentuser}),!o.currentuser&&s.currentuser&&(o.currentuser=s.currentuser.role,e.user=o.currentuser),console.log(e.user);var g={bottom:!1,top:!0,left:!1,right:!0};e.toastPosition=angular.extend({},g),e.getToastPosition=function(){return d(),Object.keys(e.toastPosition).filter(function(t){return e.toastPosition[t]}).join(" ")};var m=c(firebase.database().ref("/settings/content"));m.$loaded().then(function(){e.toastdata=m,console.log("toastdata",e.toastdata)}),e.states=[{name:"Alabama",statename:"AL"},{name:"Alaska",statename:"AK"},{name:"Arizona",statename:"AZ"},{name:"Arkansas",statename:"AR"},{name:"California",statename:"CA"},{name:"Colorado",statename:"CO"},{name:"Connecticut",statename:"CT"},{name:"Delaware",statename:"DE"},{name:"Florida",statename:"FL"},{name:"Georgia",statename:"GA"},{name:"Hawaii",statename:"HI"},{name:"Idaho",statename:"ID"},{name:"Illinois",statename:"IL"},{name:"Indiana",statename:"IN"},{name:"Iowa",statename:"IA"},{name:"Kansas",statename:"KS"},{name:"Kentucky",statename:"KY"},{name:"Louisiana",statename:"LA"},{name:"Maine",statename:"ME"},{name:"Maryland",statename:"MD"},{name:"Massachusetts",statename:"MA"},{name:"Michigan",statename:"MI"},{name:"Minnesota",statename:"MN"},{name:"Mississippi",statename:"MS"},{name:"Missouri",statename:"MO"},{name:"Montana",statename:"MT"},{name:"Nebraska",statename:"NE"},{name:"Nevada",statename:"NV"},{name:"New Hampshire",statename:"NH"},{name:"New Jersey",statename:"NJ"},{name:"New Mexico",statename:"NM"},{name:"New York",statename:"NY"},{name:"North Carolina",statename:"NC"},{name:"North Dakota",statename:"ND"},{name:"Ohio",statename:"OH"},{name:"Oklahoma",statename:"OK"},{name:"Oregon",statename:"OR"},{name:"Pennsylvania",statename:"PA"},{name:"Rhode Island",statename:"RI"},{name:"South Carolina",statename:"SC"},{name:"South Dakota",statename:"SD"},{name:"Tennessee",statename:"TN"},{name:"Texas",statename:"TX"},{name:"Utah",statename:"UT"},{name:"Vermont",statename:"VT"},{name:"Virginia",statename:"VA"},{name:"Washington",statename:"WA"},{name:"West Virginia",statename:"WV"},{name:"Wisconsin",statename:"WI"},{name:"Wyoming",statename:"WY"}],e.numberOfPages=function(t){console.log(t,e.videos.length),e.pageSize=parseInt(t),e.pagenum=Math.ceil(e.videos.length/parseInt(t))},e.upload=function(a){if(console.log("data",a),e.file)if(e.showloading=!0,console.log(e.file),"video/mp4"==e.file.type){var n=e.uniqueString()+"-"+e.file.name,s={"Content-Type":"application/json"},i={file_name:n,access_level:o.currentuser.access_level,username:o.currentuser.username,s3location:nowstate,file_type:"video/mp4",auth_token:o.currentuser.auth_token};t.post("https://api.skyebrowse.com:3000/api/UserModels/createFile",i,s).then(function(t){console.log("createFile",t);var a={Key:n,ContentType:e.file.type,Body:e.file,ServerSideEncryption:"AES256"};bucket.putObject(a,function(t,a){if(console.log("inside putObject"),t)return console.log(t.message,t.code),e.showloading=!1,o.filename=null,r.show(r.simple().content(e.toastdata.uploadvideotoast).position(e.getToastPosition()).hideDelay(4e3)),!1;console.log("Video File Uploaded Successfully","Done"),p(bucketname,n,nowstate)})},function(t){console.log("err createFile",t.data.error.message),e.showloading=!1,o.filename=null,r.show(r.simple().content(t.data.error.message).position(e.getToastPosition()).hideDelay(4e3))})}else console.log("Please upload mp4 file only"),e.showloading=!1,o.filename=null,r.show(r.simple().content(e.toastdata.videofilevalidatetoast).position(e.getToastPosition()).hideDelay(4e3));else console.log("Please select a file to upload"),r.show(r.simple().content(e.toastdata.videofilevalidatetoast).position(e.getToastPosition()).hideDelay(4e3))},e.uniqueString=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<8;a++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}}]).filter("pagination",[function(){return function(e,t){return t=+t,e.slice(t)}}]).directive("file",["$rootScope",function(e){return{restrict:"AE",scope:{file:"@"},link:function(t,a,n){a.bind("change",function(a){var n=a.target.files[0];t.file=n,t.$parent.file=n,e.filename=n.name,console.log("scope file",t.file),console.log("$rootScope.filename",e.filename),t.$apply()})}}}])}();